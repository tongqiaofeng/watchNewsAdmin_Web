{"remainingRequest":"G:\\aa-tong\\my-project\\watchNewsAdmin_Web\\node_modules\\thread-loader\\dist\\cjs.js!G:\\aa-tong\\my-project\\watchNewsAdmin_Web\\node_modules\\babel-loader\\lib\\index.js!G:\\aa-tong\\my-project\\watchNewsAdmin_Web\\src\\utils\\uploadImgs.js","dependencies":[{"path":"G:\\aa-tong\\my-project\\watchNewsAdmin_Web\\src\\utils\\uploadImgs.js","mtime":1657072160053},{"path":"G:\\aa-tong\\my-project\\watchNewsAdmin_Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\aa-tong\\my-project\\watchNewsAdmin_Web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"G:\\aa-tong\\my-project\\watchNewsAdmin_Web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudWludDgtYXJyYXkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5jb3B5LXdpdGhpbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmV2ZXJ5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsbCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbHRlciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kLWluZGV4IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluZGV4LW9mIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubGFzdC1pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lm1hcCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnJlZHVjZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnJlZHVjZS1yaWdodCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnJldmVyc2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zZXQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zb3J0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc3ViYXJyYXkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1sb2NhbGUtc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tc3RyaW5nIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IHN0b3JlIGZyb20gIi4uL3N0b3JlIjsKdmFyIFVwbG9hZEltZyA9IHsKICAvLyDlr4zmlofmnKwg5LiK5Lyg5Zu+54mHCiAgaGFuZGxlQWRkX3F1aWxsX2VkaXRvcjogZnVuY3Rpb24gaGFuZGxlQWRkX3F1aWxsX2VkaXRvcih2YWwpIHsKICAgIHZhciBmaWxlID0gdmFsOwogICAgdmFyIHRoYXQgPSB0aGlzOwoKICAgIGlmIChmaWxlID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZWQsIHJlamVjdGVkKSB7CiAgICAgIGlmIChmaWxlLnNpemUgLyAxMDI0ID4gMTAyNSkgewogICAgICAgIHRoYXQucGhvdG9Db21wcmVzcyhmaWxlLCB7CiAgICAgICAgICBxdWFsaXR5OiAwLjcKICAgICAgICB9LCBmdW5jdGlvbiAoYmFzZTY0Q29kZXMpIHsKICAgICAgICAgIHZhciBhcnIgPSBiYXNlNjRDb2Rlcy5zcGxpdCgiLCIpLAogICAgICAgICAgICAgIG1pbWUgPSBhcnJbMF0ubWF0Y2goLzooLio/KTsvKVsxXSwKICAgICAgICAgICAgICAvLyDljrvmjol1cmznmoTlpLTvvIzlubbovazljJbkuLpieXRlCiAgICAgICAgICBic3RyID0gYXRvYihhcnJbMV0pLAogICAgICAgICAgICAgIC8vIOWkhOeQhuW8guW4uCzlsIZhc2NpaeeggeWwj+S6jjDnmoTovazmjaLkuLrlpKfkuo4wCiAgICAgICAgICBuID0gYnN0ci5sZW5ndGgsCiAgICAgICAgICAgICAgdThhcnIgPSBuZXcgVWludDhBcnJheShuKTsKCiAgICAgICAgICB3aGlsZSAobi0tKSB7CiAgICAgICAgICAgIHU4YXJyW25dID0gYnN0ci5jaGFyQ29kZUF0KG4pOwogICAgICAgICAgfQoKICAgICAgICAgIHZhciBmaWxlbmFtZSA9IERhdGUucGFyc2UobmV3IERhdGUoKSkgKyAiLmpwZyI7IC8vIOi9rGZpbGUKCiAgICAgICAgICB2YXIgYmwgPSBuZXcgRmlsZShbdThhcnJdLCBmaWxlbmFtZSwgewogICAgICAgICAgICB0eXBlOiBtaW1lCiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpOyAvL+WIm+W7umZvcm3lr7nosaEKCiAgICAgICAgICBmb3JtZGF0YS5hcHBlbmQoInVwbG9hZC1pbWFnZXMiLCBibCk7IC8v6YCa6L+HYXBwZW5k5ZCRZm9ybeWvueixoea3u+WKoOaVsOaNrgoKICAgICAgICAgIGF4aW9zLnBvc3Qoc3RvcmUuc3RhdGUuYmFzZVVybCArICIvc3RvY2svdXBsb2FkIiwgZm9ybWRhdGEpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBjb25zb2xlLmxvZygi5a+M5paH5pys57yW6L6R5Zmo5LiK5Lyg5Zu+54mHIiwgcmVzKTsKICAgICAgICAgICAgdmFyIHBhdGhVcmwgPSBzdG9yZS5zdGF0ZS5iYXNlVXJsICsgIi9zdG9jay9maWxlLyIgKyByZXMuZGF0YS5zcGxpdCgifCIpWzBdOwogICAgICAgICAgICByZXNvbHZlZChwYXRoVXJsKTsKICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgcmVqZWN0ZWQoZXJyKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIOWwj+S6juetieS6jjFNIOWOn+WbvuS4iuS8oAogICAgICAgIHZhciBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpOyAvL+WIm+W7umZvcm3lr7nosaEKCiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKCJ1cGxvYWQtaW1hZ2VzIiwgZmlsZSk7IC8v6YCa6L+HYXBwZW5k5ZCRZm9ybeWvueixoea3u+WKoOaVsOaNrgoKICAgICAgICBheGlvcy5wb3N0KHN0b3JlLnN0YXRlLmJhc2VVcmwgKyAiL3N0b2NrL3VwbG9hZCIsIGZvcm1kYXRhKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCLlr4zmlofmnKznvJbovpHlmajkuIrkvKDlm77niYciLCByZXMpOwogICAgICAgICAgdmFyIHBhdGhVcmwgPSBzdG9yZS5zdGF0ZS5iYXNlVXJsICsgIi9zdG9jay9maWxlLyIgKyByZXMuZGF0YS5zcGxpdCgifCIpWzBdOwogICAgICAgICAgcmVzb2x2ZWQocGF0aFVybCk7CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgIHJlamVjdGVkKGVycik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0pOwogIH0sCgogIC8q5Y6L57yp5Zu+54mHDQogICAgZmlsZe+8muaWh+S7tijnsbvlnovmmK/lm77niYfmoLzlvI8p77yMDQogICAgb2Jq77ya5paH5Lu25Y6L57yp5ZCO5a+56LGhd2lkdGjvvIwgaGVpZ2h077yMIHF1YWxpdHkoMC0xKQ0KICAgIGNhbGxiYWNr77ya5a655Zmo5oiW6ICF5Zue6LCD5Ye95pWwDQogICAgKi8KICBwaG90b0NvbXByZXNzOiBmdW5jdGlvbiBwaG90b0NvbXByZXNzKGZpbGUsIG9iaiwgY2FsbGJhY2spIHsKICAgIHZhciByZWFkeSA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAvKiDlvIDlp4vor7vlj5bmjIflrppGaWxl5a+56LGh5Lit55qE5YaF5a65LiDor7vlj5bmk43kvZzlrozmiJDml7Ys6L+U5Zue5LiA5LiqVVJM5qC85byP55qE5a2X56ym5LiyLiAqLwoKICAgIHJlYWR5LnJlYWRBc0RhdGFVUkwoZmlsZSk7CgogICAgcmVhZHkub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgIHZhciBwYXRoID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsgLy8g5byA5aeL5Y6L57ypCgogICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7CiAgICAgIGltZy5zcmMgPSBwYXRoOwoKICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgdGhhdCA9IHRoaXM7IC8vIOaMh+WIsGltZwogICAgICAgIC8vIOm7mOiupOaMieavlOS+i+WOi+e8qQoKICAgICAgICB2YXIgdyA9IHRoYXQud2lkdGgsCiAgICAgICAgICAgIGggPSB0aGF0LmhlaWdodCwKICAgICAgICAgICAgc2NhbGUgPSB3IC8gaDsKICAgICAgICB3ID0gb2JqLndpZHRoIHx8IHc7CiAgICAgICAgaCA9IG9iai5oZWlnaHQgfHwgdyAvIHNjYWxlOwogICAgICAgIHZhciBxdWFsaXR5ID0gMC43OyAvLyDpu5jorqTlm77niYfotKjph4/kuLowLjcKICAgICAgICAvLyDnlJ/miJBjYW52YXMKCiAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsgLy8g5Yib5bu65bGe5oCn6IqC54K5CgogICAgICAgIHZhciBhbncgPSBkb2N1bWVudC5jcmVhdGVBdHRyaWJ1dGUoIndpZHRoIik7CiAgICAgICAgYW53Lm5vZGVWYWx1ZSA9IHc7CiAgICAgICAgdmFyIGFuaCA9IGRvY3VtZW50LmNyZWF0ZUF0dHJpYnV0ZSgiaGVpZ2h0Iik7CiAgICAgICAgYW5oLm5vZGVWYWx1ZSA9IGg7CiAgICAgICAgY2FudmFzLnNldEF0dHJpYnV0ZU5vZGUoYW53KTsKICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlTm9kZShhbmgpOyAvLyDpk7rlupXoibIKCiAgICAgICAgY3R4LmZpbGxTdHlsZSA9ICIjZmZmIjsKICAgICAgICBjdHguZmlsbFJlY3QoMCwgMCwgdywgaCk7CiAgICAgICAgY3R4LmRyYXdJbWFnZSh0aGF0LCAwLCAwLCB3LCBoKTsgLy8g5Zu+5YOP6LSo6YePCgogICAgICAgIGlmIChvYmoucXVhbGl0eSAmJiBvYmoucXVhbGl0eSA+PSAxICYmIG9iai5xdWFsaXR5IDwgMCkgewogICAgICAgICAgcXVhbGl0eSA9IG9iai5xdWFsaXR5OwogICAgICAgIH0gLy8gcXVhbGl0eeWAvOi2iuWwj++8jOaJgOe7mOWItuWHuueahOWbvuWDj+i2iuaooeezigoKCiAgICAgICAgdmFyIGJhc2U2NCA9IGNhbnZhcy50b0RhdGFVUkwoImltYWdlL2pwZWciLCBxdWFsaXR5KTsgLy8g5Zue6LCD5Ye95pWw6L+U5ZueYmFzZTY055qE5YC8CgogICAgICAgIGNhbGxiYWNrKGJhc2U2NCk7CiAgICAgIH07CiAgICB9OwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgVXBsb2FkSW1nOw=="},{"version":3,"sources":["G:/aa-tong/my-project/watchNewsAdmin_Web/src/utils/uploadImgs.js"],"names":["axios","store","UploadImg","handleAdd_quill_editor","val","file","that","undefined","Promise","resolved","rejected","size","photoCompress","quality","base64Codes","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","filename","Date","parse","bl","File","type","formdata","FormData","append","post","state","baseUrl","then","res","console","log","pathUrl","data","catch","err","obj","callback","ready","FileReader","readAsDataURL","onload","event","path","target","result","img","Image","src","w","width","h","height","scale","canvas","document","createElement","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","fillStyle","fillRect","drawImage","base64","toDataURL"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport store from \"../store\";\r\n\r\nconst UploadImg = {\r\n  // 富文本 上传图片\r\n  handleAdd_quill_editor(val) {\r\n    let file = val;\r\n\r\n    let that = this;\r\n    if (file === undefined) {\r\n      return;\r\n    }\r\n\r\n    return new Promise((resolved, rejected) => {\r\n      if (file.size / 1024 > 1025) {\r\n        that.photoCompress(\r\n          file, {\r\n            quality: 0.7,\r\n          },\r\n          (base64Codes) => {\r\n            let arr = base64Codes.split(\",\"),\r\n              mime = arr[0].match(/:(.*?);/)[1], // 去掉url的头，并转化为byte\r\n              bstr = atob(arr[1]), // 处理异常,将ascii码小于0的转换为大于0\r\n              n = bstr.length,\r\n              u8arr = new Uint8Array(n);\r\n            while (n--) {\r\n              u8arr[n] = bstr.charCodeAt(n);\r\n            }\r\n\r\n            let filename = Date.parse(new Date()) + \".jpg\";\r\n            // 转file\r\n            let bl = new File([u8arr], filename, {\r\n              type: mime,\r\n            });\r\n\r\n            let formdata = new FormData(); //创建form对象\r\n            formdata.append(\"upload-images\", bl); //通过append向form对象添加数据\r\n\r\n            axios.post(store.state.baseUrl + \"/stock/upload\", formdata).then((res) => {\r\n              console.log(\"富文本编辑器上传图片\", res);\r\n              let pathUrl = store.state.baseUrl + \"/stock/file/\" + res.data.split(\"|\")[0];\r\n              resolved(pathUrl);\r\n            }).catch((err) => {\r\n              console.log(err);\r\n              rejected(err)\r\n            });\r\n          }\r\n        );\r\n      } else {\r\n        // 小于等于1M 原图上传\r\n        let formdata = new FormData(); //创建form对象\r\n        formdata.append(\"upload-images\", file); //通过append向form对象添加数据\r\n\r\n        axios.post(store.state.baseUrl + \"/stock/upload\", formdata).then((res) => {\r\n          console.log(\"富文本编辑器上传图片\", res);\r\n          let pathUrl = store.state.baseUrl + \"/stock/file/\" + res.data.split(\"|\")[0];\r\n          resolved(pathUrl);\r\n        }).catch((err) => {\r\n          console.log(err);\r\n          rejected(err)\r\n        });\r\n      }\r\n    })\r\n  },\r\n  /*压缩图片\r\n    file：文件(类型是图片格式)，\r\n    obj：文件压缩后对象width， height， quality(0-1)\r\n    callback：容器或者回调函数\r\n    */\r\n  photoCompress(file, obj, callback) {\r\n    let ready = new FileReader();\r\n    /* 开始读取指定File对象中的内容. 读取操作完成时,返回一个URL格式的字符串. */\r\n    ready.readAsDataURL(file);\r\n    ready.onload = (event) => {\r\n      let path = event.target.result;\r\n\r\n      // 开始压缩\r\n      let img = new Image();\r\n      img.src = path;\r\n      img.onload = function () {\r\n        let that = this; // 指到img\r\n        // 默认按比例压缩\r\n        let w = that.width,\r\n          h = that.height,\r\n          scale = w / h;\r\n        w = obj.width || w;\r\n        h = obj.height || w / scale;\r\n        let quality = 0.7; // 默认图片质量为0.7\r\n        // 生成canvas\r\n        let canvas = document.createElement(\"canvas\");\r\n        let ctx = canvas.getContext(\"2d\");\r\n\r\n        // 创建属性节点\r\n        let anw = document.createAttribute(\"width\");\r\n        anw.nodeValue = w;\r\n        let anh = document.createAttribute(\"height\");\r\n        anh.nodeValue = h;\r\n        canvas.setAttributeNode(anw);\r\n        canvas.setAttributeNode(anh);\r\n        // 铺底色\r\n        ctx.fillStyle = \"#fff\";\r\n        ctx.fillRect(0, 0, w, h);\r\n        ctx.drawImage(that, 0, 0, w, h);\r\n\r\n        // 图像质量\r\n        if (obj.quality && obj.quality >= 1 && obj.quality < 0) {\r\n          quality = obj.quality;\r\n        }\r\n        // quality值越小，所绘制出的图像越模糊\r\n        let base64 = canvas.toDataURL(\"image/jpeg\", quality);\r\n        // 回调函数返回base64的值\r\n        callback(base64);\r\n      };\r\n    };\r\n  }\r\n}\r\nexport default UploadImg"]}]}